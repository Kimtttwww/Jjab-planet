<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="boardMapper">
	<resultMap type="Corporation" id="corpResultSet"/>

	
<!-- 	<resultMap type="board" id="boardResultSet"> -->
<!-- 		<id column="BOARD_NO" property="boardNo"/> -->
<!-- 		<result column="USER_ID" property="userId"/> -->
		
<!-- 		<collection property="list" javaType="java.util.ArrayList" -->
<!-- 			ofType="reply" select="selectReplyList" column="BOARD_NO"/> -->
		<!-- 
			댓글 LIST를 담기 위해서 ArrayList<Reply> 객체를 생성
			javaType="java.util.ArrayList" ofType="reply"
			
			selectReplyList 쿼리를 수행하기 위해 필요한 파라미터는
			현재 resultMap으로 조회된 BOARD_NO 컬럼을 사용하겠다
			(select="selectReplyList" column="BOARD_NO")
		 -->
<!-- 	</resultMap> -->
	
	
	<!--  다연 사용중 -->
	<!--  기업 등록개수 -->
	<select id="corpCount" resultType="_int">
	   SELECT COUNT(*)
		  FROM CORPORATION		
	</select>
	
	<!--  리뷰 등록개수 -->
	<select id="reviewCount" resultType="_int">
	   SELECT COUNT(*)
		  FROM BOARD_REPLY
		WHERE STATUS='Y' AND REPLY_TYPE='R' 		
		AND REF_NO = #{corpCode}		
	</select>
	
	<!--  기업 전체리스트 -->
	<select id="selectCorpList" resultMap="corpResultSet" >
  		SELECT *
	      FROM CORPORATION 	
	</select>
	
	
	<!--  선택한 기업정보 -->
	<select id="selectCorpOne" resultType="com.kh.corporation.model.vo.Corporation"  >
	    SELECT * 
	      FROM CORPORATION
	     WHERE CORP_NO = #{corpCode}
	</select>
	
	<!--  선택한 기업 로고 -->
	<select id="selectLogoOne" resultType="com.kh.corporation.model.vo.Corporation"  >
	    SELECT * 
	      FROM LOGO
	     WHERE CORP_NO = #{corpCode}
	</select>
	
	
	
	
	<!--  기업의 리뷰리스트  -->
	<select id="selectReviewList" resultType="com.kh.community.model.vo.Reply">
	    SELECT R.REPLY_NO, R.REPLY_CONTENT, M.USER_ID, R.CREATE_DATE
	    FROM BOARD_REPLY R
	  	JOIN MEMBER M ON (M.USER_NO = R.REPLY_WRITER)
	    WHERE R.STATUS = 'Y'
	      AND R.REPLY_TYPE = 'R'
	      AND R.REF_NO = #{corpCode}
	    ORDER BY R.REPLY_NO DESC
	</select>
	
	<!--  기업 공고 클릭시 조회수 증가  -->
	<update id="increaseCount" parameterType="_int">
		UPDATE BOARD
		SET COUNT = COUNT + 1
		WHERE JOP_NO = #{boardNo}
	</update>
	
	<!--  기업 정보에 해당 기업공고 노출  -->
	<select id="selectJopPostList" resultType="com.kh.jobpost.model.vo.JobPost">
		SELECT POST_TITLE, POST_CONTENT, CREATE_DATE, JOB_NAME
		  FROM JOP_POST P
		  JOIN OCCUPATION USING (JOB_NO)
		 WHERE CORP_NO = #{corpCode}
		
	</select>
	<!-- 다연 사용중 -->
	
	
	
	
	
	
	<!--
		* DML문 일 경우
			<insert id="식별자" parameterType="전달받은 자바타입">
		 
			</insert>
		 
			<update></update>
			<delete></delete>
		=> DML문은 처리된 행의 갯수를 반환하기 떄문에 resultType이나 resultMap 생략이 가능하다
	 -->
	 
	 <!--

 -->
<!-- 	<select id="selectBoard" parameterType="_int" resultMap="boardResultSet"> -->
<!-- 		SELECT BOARD_NO, BOARD_TITLE, BOARD_CONTENT, USER_ID, COUNT, CREATE_DATE -->
<!-- 		FROM BOARD B -->
<!-- 		JOIN MEMBER ON BOARD_WRITER = USER_NO -->
<!-- 		WHERE B.STATUS = 'Y' AND BOARD_NO = #{boardNo} -->
<!-- 	</select> -->
	
<!-- 	<select id="selectReplyList" resultMap="replyResultSet" parameterType="_int"> -->
<!-- 		SELECT USER_ID, REPLY_CONTENT, CREATE_DATE -->
<!-- 		FROM REPLY R -->
<!-- 		JOIN MEMBER ON REPLY_WRITER = USER_NO -->
<!-- 		WHERE R.STATUS = 'Y' AND REF_BNO = #{boardNo} -->
<!-- 		ORDER BY REPLY_NO DESC -->
<!-- 	</select> -->
	
<!-- 	<select id="selectSearchList" parameterType="hashmap" resultType="board"> -->
<!-- 		SELECT BOARD_NO, BOARD_TITLE, USER_ID, COUNT, CREATE_DATE -->
<!-- 	    FROM BOARD B -->
<!-- 	    JOIN MEMBER ON BOARD_WRITER = USER_NO -->
<!-- 	    WHERE B.STATUS = 'Y' -->
<!-- 	    <if test="condition == 'writer'"> -->
<!--     		AND USER_ID -->
<!-- 	    </if> -->
<!-- 	    <if test="condition.equals('title')"> -->
<!--     		AND BOARD_TITLE -->
<!-- 	    </if> -->
<!-- 	    <if test="condition == 'content'"> -->
<!--     		AND BOARD_CONTENT -->
<!-- 	    </if> -->
<!-- 	     LIKE '%' || #{keyword} || '%' -->
<!-- 	    ORDER BY BOARD_NO DESC -->
<!-- 	</select> -->
	<!--
	<select id="selectSearchCount" parameterType="hashmap" resultType="int">
		SELECT COUNT(*) FROM BOARD B
		JOIN MEMBER ON BOARD_WRITER = USER_NO
		WHERE B.STATUS = 'Y'
		<choose>
			<when test="condition == 'writer'">
				AND USER_ID
			</when>
			<when test="condition == 'writer'">
				AND BOARD_TITLE
			</when>
			<otherwise>
				AND BOARD_CONTENT
			</otherwise>
		</choose>
		LIKE '%' || #{keyword} || '%'
		ORDER BY BOARD_NO DESC
	</select>
	-->
<!-- 	<update id="" parameterType="_int"> -->
<!-- 		UPDATE BOARD SET BOARD_NO = #{boardNo} -->
<!-- 		WHERE BOARD_NO = #{boardNo} and STATUS = 'Y' -->
<!-- 	</update> -->
	 
	
<!-- 	<insert id="insertMember" parameterType="member"> -->
<!-- 		INSERT INTO MEMBER(USER_NO, USER_ID, USER_PWD, USER_NAME, EMAIL, BIRTHDAY, GENDER, PHONE, ADDRESS) -->
<!-- 		VALUES(SEQ_UNO.NEXTVAL, #{userId}, #{userPwd}, #{userName}, #{email}, #{birthday}, #{gender}, #{phone}, #{address}) -->
<!-- 	</insert> -->
	  
</mapper>