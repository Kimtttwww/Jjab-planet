<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="communityMapper">
	<resultMap id="postResultSet" type="post"/>
	
<!-- 	<resultMap type="board" id="boardResultSet"> -->
<!-- 		<id column="BOARD_NO" property="boardNo"/> -->
<!-- 		<result column="USER_ID" property="userId"/> -->
		
<!-- 		<collection property="list" javaType="java.util.ArrayList" -->
<!-- 			ofType="reply" select="selectReplyList" column="BOARD_NO"/> -->
		<!-- 
			댓글 LIST를 담기 위해서 ArrayList<Reply> 객체를 생성
			javaType="java.util.ArrayList" ofType="reply"
			
			selectReplyList 쿼리를 수행하기 위해 필요한 파라미터는
			현재 resultMap으로 조회된 BOARD_NO 컬럼을 사용하겠다
			(select="selectReplyList" column="BOARD_NO")
		 -->
<!-- 	</resultMap> -->
	
	
	<!--  태완 사용중 -->
	<select id="selectPostCount" parameterType="string" resultType="_int">
	    SELECT COUNT(*) FROM BOARD_POST
	    WHERE STATUS = 'Y'
		<if test='!category.equals("A")'>
		    AND CATEGORY = #{category}
	    </if>
	</select>
	
	<select id="selectPostList" parameterType="string" resultMap="postResultSet">
	    SELECT POST_NO, POST_TITLE, POST_CONTENT, USER_ID, COUNT, CREATE_DATE
		FROM BOARD_POST P
		JOIN MEMBER ON POST_WRITER = USER_NO
		WHERE P.STATUS = 'Y'
		<if test='!category.equals("A")'>
		    AND CATEGORY = #{category}
	    </if>
		ORDER BY POST_NO DESC
	</select>
	
	<insert id="insertPost" parameterType="post">
		INSERT INTO BOARD_POST(POST_NO, POST_TITLE, POST_CONTENT, POST_WRITER, CATEGORY)
		VALUES(SEQ_BOARD_POSTNO.NEXTVAL, #{postNo}, #{postTitle}, #{postContent}, #{postWriter}, #{category})
	</insert>
	<!-- 태완 사용중 -->
	
	
	
	
	
	
<!-- 	<update id="increaseCount" parameterType="_int"> -->
<!-- 		UPDATE BOARD -->
<!-- 		SET COUNT = COUNT + 1 -->
<!-- 		WHERE BOARD_NO = #{boardNo} -->
<!-- 	</update> -->

<!-- 	<select id="selectBoard" parameterType="_int" resultMap="boardResultSet"> -->
<!-- 		SELECT BOARD_NO, BOARD_TITLE, BOARD_CONTENT, USER_ID, COUNT, CREATE_DATE -->
<!-- 		FROM BOARD B -->
<!-- 		JOIN MEMBER ON BOARD_WRITER = USER_NO -->
<!-- 		WHERE B.STATUS = 'Y' AND BOARD_NO = #{boardNo} -->
<!-- 	</select> -->
	
<!-- 	<select id="selectReplyList" resultMap="replyResultSet" parameterType="_int"> -->
<!-- 		SELECT USER_ID, REPLY_CONTENT, CREATE_DATE -->
<!-- 		FROM REPLY R -->
<!-- 		JOIN MEMBER ON REPLY_WRITER = USER_NO -->
<!-- 		WHERE R.STATUS = 'Y' AND REF_BNO = #{boardNo} -->
<!-- 		ORDER BY REPLY_NO DESC -->
<!-- 	</select> -->
	
<!-- 	<select id="selectSearchList" parameterType="hashmap" resultType="board"> -->
<!-- 		SELECT BOARD_NO, BOARD_TITLE, USER_ID, COUNT, CREATE_DATE -->
<!-- 	    FROM BOARD B -->
<!-- 	    JOIN MEMBER ON BOARD_WRITER = USER_NO -->
<!-- 	    WHERE B.STATUS = 'Y' -->
<!-- 	    <if test="condition == 'writer'"> -->
<!--     		AND USER_ID -->
<!-- 	    </if> -->
<!-- 	    <if test="condition.equals('title')"> -->
<!--     		AND BOARD_TITLE -->
<!-- 	    </if> -->
<!-- 	    <if test="condition == 'content'"> -->
<!--     		AND BOARD_CONTENT -->
<!-- 	    </if> -->
<!-- 	     LIKE '%' || #{keyword} || '%' -->
<!-- 	    ORDER BY BOARD_NO DESC -->
<!-- 	</select> -->
	
<!-- 	<select id="selectSearchCount" parameterType="hashmap" resultType="int"> -->
<!-- 		SELECT COUNT(*) FROM BOARD B -->
<!-- 		JOIN MEMBER ON BOARD_WRITER = USER_NO -->
<!-- 		WHERE B.STATUS = 'Y' -->
<!-- 		<choose> -->
<!-- 			<when test="condition == 'writer'"> -->
<!-- 				AND USER_ID -->
<!-- 			</when> -->
<!-- 			<when test="condition == 'writer'"> -->
<!-- 				AND BOARD_TITLE -->
<!-- 			</when> -->
<!-- 			<otherwise> -->
<!-- 				AND BOARD_CONTENT -->
<!-- 			</otherwise> -->
<!-- 		</choose> -->
<!-- 		LIKE '%' || #{keyword} || '%' -->
<!-- 		ORDER BY BOARD_NO DESC -->
<!-- 	</select> -->
<!-- 	<update id="" parameterType="_int"> -->
<!-- 		UPDATE BOARD SET BOARD_NO = #{boardNo} -->
<!-- 		WHERE BOARD_NO = #{boardNo} and STATUS = 'Y' -->
<!-- 	</update> -->
	 
	
	
</mapper>